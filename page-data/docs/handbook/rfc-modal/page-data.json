{
    "componentChunkName": "component---src-templates-documentation-tsx",
    "path": "/docs/handbook/rfc-modal",
    "result": {"data":{"markdownRemark":{"id":"6598887c-4195-5d48-baab-3cfa02548838","excerpt":"Possible concept for supporting modes in LF. Motivation Structured behavior Both in text and diagrams Built-in state machines Dependencies Accept cyclic…","html":"<p>Possible concept for supporting modes in LF.</p>\n<h2 id=\"motivation\" style=\"position:relative;\"><a href=\"#motivation\" aria-label=\"motivation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Motivation</h2>\n<ul>\n<li>Structured behavior\n<ul>\n<li>Both in text and diagrams</li>\n<li>Built-in state machines</li>\n</ul>\n</li>\n<li>Dependencies\n<ul>\n<li>Accept cyclic dependencies if involved reactions are mutually exclusive.</li>\n</ul>\n</li>\n<li>Verification\n<ul>\n<li>Mode-dependent invariants / conditions</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"synthetic-examples\" style=\"position:relative;\"><a href=\"#synthetic-examples\" aria-label=\"synthetic examples permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Synthetic Examples</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQoz3WR2Y6CQBBF+f+f4IEP8B14MGL8AEAJLiGyBJA1oKiA3sntZAgz0Uoq6aXu6VvV0uPxwDAM6PteJNfzHMcRURSJ5PpTzTyl1+uF/8Gz6/WK2+2GqqpwOp1g2zayLMP9fhd330JqmgZd12G328FxHAFr2xZFUeByuUDXdazXawRBIPaE8o6P0fH7/f4LPJ/PSJIEy+USq9UKdV1ju90ijmMBWSwW2Gw2eD6fsCwLsixDVVWEYShq0zQVtTRB5xL7ngdfpJiu6YRCipjsgG4Jpo4QjsMwDJimCZqbgAT92ufg8zwXMNd1cTgcRBd0rigKNE0T7gnkjMuynGb+FXg8HgXI8zzs93v4vj+JOXfWfPqUH5HIEDpMjP9lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"motor\"\n        title=\"motor\"\n        src=\"/static/e1ab6a864659dd9670ba7fdb927f0646/5a190/motor.png\"\n        srcset=\"/static/e1ab6a864659dd9670ba7fdb927f0646/772e8/motor.png 200w,\n/static/e1ab6a864659dd9670ba7fdb927f0646/e17e5/motor.png 400w,\n/static/e1ab6a864659dd9670ba7fdb927f0646/5a190/motor.png 800w,\n/static/e1ab6a864659dd9670ba7fdb927f0646/b2cef/motor.png 847w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Separating reaction 2 and 3 of the Controller reactor into mutually exclusive modes could allow to ensure via static verification that at no time the Motor reactor receives a <code class=\"language-text\">fwd</code> and <code class=\"language-text\">rev</code> input simultaneously.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADCElEQVQ4y42Ua08bRxSG/afTD0kgCnH7rVJFaEmkUpTEVHwgIqFCKlQQYggGvGviG/E18t34Asbswnpv87Sz9jq2WkSP9EozZ3eeOe+c2Q0IIfAEYLvUl58T//E7vr58RmHxKWfzjym+eEpmYZbcz0+8+dn8DF8WZqj+9AQ0zVvrcwKSgw+0HDK/v2B76Rnvn8+wsTDLny/n2Fn6nr9+DXpan3/MHwuzbC//wOkvQdx+H58hI+C6Lt8ksPJZzNMomnKMrhxjJGII9RhXOWKQPPVyN7EoRiyKmYzjWBauEGNG4Pb2Ftu2sSzLkw04gDvcF92yyRSKlBsNbmzbyzkjydnkWqmAaZpMhnDdsWSYhkEumyGXzXKj6+O8H7IqMTEPDAaD0RGIafDokCfDcRy63S6KoniKx+O0Wi0mGQFZph/SvmEY4xf+C67rOolEgpOTE1RV5fz8HN+lB2y326TTaQ+yubnJysoKq6urVKtV73zkJtZoQTqVolQqUSgUCIVCLC4usru76xUxBtZqNWKxGP1+n729PQ+6tbVFs9n0dr7q94knkyiqihKPU2s0SKVSrK2teZtHIpG7Lf8rpE3TpN9u0202cWWnOx00XedW1xkYBtr19XSFkj7+WnyNOic+f0ZkMlAqQaWC/vYt2vY211dXaLaNJh2MwP4NCUwe6JRkMpsdXwlbdtg00SoVeqpKMxajGY1ykc/T07Sx7SnglFUZyaRXoSgWoVzGefeOmw8f6Lx+zfKDBwQfPeIkGMR68warUoF0+g6gf3k/fULkct7Q6PU4LxS4yWS4DIfJrq9zFgpRj0Swut0h4+joHuDhIaJaHdoWAmlKK5fpHRyQ39jgy9ISdVXF7HSGjETifqBsiBjl5H3ULi9ph0L89vAhc3NzHAWDOK9e4eTzsL//PyxXKt8a47pcGQaXxSKNw0NPF9ksF6aJ0WjAzs49wGgUUilEp4OQC5pNrHIZs1bDbrU8WfX68FmhgAiH7/g5+EBFgY8f4eAAsb/vWZJj/LGvcBgRiSD+qfBvOLCCh5vKszwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cyclic dep\"\n        title=\"cyclic dep\"\n        src=\"/static/d28415b6b207ff232618d94b6c779808/10f9a/cyclic_dep.png\"\n        srcset=\"/static/d28415b6b207ff232618d94b6c779808/772e8/cyclic_dep.png 200w,\n/static/d28415b6b207ff232618d94b6c779808/e17e5/cyclic_dep.png 400w,\n/static/d28415b6b207ff232618d94b6c779808/10f9a/cyclic_dep.png 539w\"\n        sizes=\"(max-width: 539px) 100vw, 539px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Separating reaction 2 and 3 of the Modes reactor into mutually exclusive modes could allow to accept this program.</p>\n<h2 id=\"design-considerations\" style=\"position:relative;\"><a href=\"#design-considerations\" aria-label=\"design considerations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Design Considerations</h2>\n<ul>\n<li>LF does not provide an expression/statement language.</li>\n<li>Only Reactions can access variables and ports via the respective target language API and target code should not be analyzed.</li>\n<li>Information about modes and their transitions must be available statically in LF to facilitate the dependency analysis and verification.</li>\n</ul>\n<p>For this proposal, the aim is (at least so far) not to create a state machine syntax with an abstract expression/statement language for triggers and effects that is compiled into target code but to reuse elements of the current polyglot approach.</p>\n<h2 id=\"basic-syntax-proposal\" style=\"position:relative;\"><a href=\"#basic-syntax-proposal\" aria-label=\"basic syntax proposal permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Syntax Proposal</h2>\n<p>Reactors may contain (two or more) mode definitions:</p>\n<ul>\n<li>A mode provides a unique ID (in the reactor scope)</li>\n<li>May consist of (only for simplicity at this point):\n<ul>\n<li>Reactions</li>\n<li>Reactor instantiations (under the same restrictions)</li>\n<li>Connections</li>\n</ul>\n</li>\n<li>It shares the scope with the reactor but not with other modes</li>\n<li>One mode must be marked as <em>initial</em></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">reactor TwoModes {\n  initial mode One {\n    ...\n  }\n  mode Two {\n    ...\n  }\n}</code></pre></div>\n<p>Reactions in modes may declare a transition to (one or more) modes.</p>\n<ul>\n<li>This enables the use of target language API to set the next state (e.g. set_mode(X))</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">reaction(trig) transition Two {=\n  if (trig->value) {\n    set_mode(Two)\n  }\n=}</code></pre></div>\n<h3 id=\"graphical-syntax\" style=\"position:relative;\"><a href=\"#graphical-syntax\" aria-label=\"graphical syntax permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Graphical Syntax</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABcSAAAXEgFnn9JSAAABXUlEQVQoz22S226bQBRF+f+fqdS39DluVLdYRTHEXExsDDjczGXAl87AqpgoSRX1SFsjzTl7aWvOGFJKxnFEKaXPWdM0MgwXmvaGEArfjzBNmzwXiF7RtlL3lZLvnjcZ0zTxuZQa2e3O+F7Mk+0QbgsW9zG/VxbuxuPJDgjDDin/6Pl/GcbtdqPrOpqm0SnnkhIc54TnWjwsvhHHEWl6JNo5LO7v2AaPrNcFUk7vwMvlwswyyrLE933CMGS5XJLnBedzz2aTsVo12HaL67YEQYfnn3lcN5imIAwrhGhp2077PM+j73uMoihIkkQnzLIMIQTDMFCWguOxoT4VFEWjoXn2Ql1XHNOCqur07KwoinBdF8uy/v+G81Uc12yDn/z68YU8eyaJI3bbBebyK8/Bd/b7HKU+vNfrVQcx3rb8WUlS4QcvOM6Bw+FEmtYkScfajtjta92fl/LxM17hfwHD/A+1o1cG8gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sine avg max modes\"\n        title=\"sine avg max modes\"\n        src=\"/static/20a6c0498dda1460a966028c3b99f4c8/5a190/sine_avg_max_modes.png\"\n        srcset=\"/static/20a6c0498dda1460a966028c3b99f4c8/772e8/sine_avg_max_modes.png 200w,\n/static/20a6c0498dda1460a966028c3b99f4c8/e17e5/sine_avg_max_modes.png 400w,\n/static/20a6c0498dda1460a966028c3b99f4c8/5a190/sine_avg_max_modes.png 800w,\n/static/20a6c0498dda1460a966028c3b99f4c8/c1b63/sine_avg_max_modes.png 1200w,\n/static/20a6c0498dda1460a966028c3b99f4c8/669eb/sine_avg_max_modes.png 1244w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>The example continuously collects 10 data samples of a sine wave and computes either the average or maximum. <a href=\"https://github.com/lf-lang/lingua-franca/blob/master/experimental/modal_models/SineAvgMax/sine_max_avg.lf\">LF source code</a>. It is based on this <a href=\"http://ptolemy.org/systems/models/modal/ModalSDF/index.html\">Ptolemy model with modes</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADDElEQVQ4y3WUy27bRhSG+UZZedku2hfIU2SXTZ4jQBtknUVWXhTIwosKqA0ZUlshRmzdTIrkiKJ5GYkUKUu1GFm2JPorZmQ7spsO8OOcOTxz+J/LjMH9uru703jQy7vyP7Y4jhn4Ps7ZGX8fHtI4OaFxdIRvmvQ9j9lshsGz9RDgm+Gb6vs+uWWxcl3mnQ5fWy0K02QjBKnjMNkNuMumKAqm00uWN8vtt3LL1vN9po4DUQRxDEKAlFqf9PvfCajo3MHr6WtezF7w4/wHTpenjwwHnkcgJbnnMRSCKMsY2jZJv4/reUzy/GnAByluBdXJMdXZXxRlQZ5mZNmY8XiMaZrYjkMUx2RpSpplJOMxaZKwXC6/E7Asmc0WTKqfKRtt7K7Jbx8/8vunT3RbLT7X6/rg/y1jl9mDvi43XOUZiwuf2eSSvmkSeQMm45w4jNiUm0f/5zB2N7tMF8slXhTQtbo6RcvtYXomrueyXq953szHgMpYUrJho2VZlttOzwv+bNXZr+7T7Xaon9aonFf44nxhdbvazuq975OUy3UJt8Bqi/VqzWazYbFYIKXUcFyHQAQUsmAez7Wf8lFMV6vVI9TesAYWv57/wtveW/aDfYIwIIoijSAI9D6VCTW3xrvuO9733lMJK8hIEsURcRw98TeaQZOXly/5afYzr7JXyJEkGSWkaiTSFJlIpvGUD/4H9iZ77M32eDN+Qz7MGY6GJGlCkmz9VVDjwr9AepIL26dvClzX1TNm2za9Xk+nPBqNCC4C8iTHFx7CEXiDgb7bQggNxS4KQwzLsjg8+oNm28YVIefn57TbbTzP0zg4ONCB6/U6x8dVLMvDsgSdTptWq0Wj0aDT6VCr1ahUKhiKgaIqREgUD/WfBoPBfV1iHHUr7mtk2w5CJEiZIuOYMAzp9/taKrbq8TBUN9XkL5fX3Nzc6IdBya39K7e3W9t8PteyKK64uvqH6+tr7aNs6rzSlc1QKZ6dnem/q/SbzaZOp9MxOTkZ4LohaZpoFgqqnlIOdROUrhqSZZmutdL/Bfrg5LKp3q7NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sine avg max pt2\"\n        title=\"sine avg max pt2\"\n        src=\"/static/e25b1647ec721daa08c248af6cc6aa90/5a190/sine_avg_max_pt2.png\"\n        srcset=\"/static/e25b1647ec721daa08c248af6cc6aa90/772e8/sine_avg_max_pt2.png 200w,\n/static/e25b1647ec721daa08c248af6cc6aa90/e17e5/sine_avg_max_pt2.png 400w,\n/static/e25b1647ec721daa08c248af6cc6aa90/5a190/sine_avg_max_pt2.png 800w,\n/static/e25b1647ec721daa08c248af6cc6aa90/bb3ba/sine_avg_max_pt2.png 1121w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Note that reactions 1 and 3 are identical and both collect a sequence into an array. This was done to mimic the structure in Ptolemy. An alternative design could separate this task into a single reaction outside the modes (following image, <a href=\"https://github.com/lf-lang/lingua-franca/blob/master/experimental/modal_models/SineAvgMax/sine_max_avg_v2.lf\">source code</a>) or into a reactor either instantiated in each mode or preprocessing inputs for the ModalModel reactor.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABcSAAAXEgFnn9JSAAABbUlEQVQoz1WRW2/aQBCF/f//Rx8q5aVIqRDQRCkxadMLjiObghNjmbr4AhXrXWww2F+1VkB0pNGMZs8ZnTlr1HXN8XhE11O/2+0oy5L9fs8qy7CsKWGYIuWBXFSURdliTjxdm6ahKAoM3kIPdGiAEILNZoOSgm9uTvfhhc7AoXcfMrQjhk/6XbTYS+52u8XQKnReLtbqpFIUSvLph6Rnj+ne97m+uaZv/+TDaIXIFU1Tn3mHwwGlFIbv+8znc6bTaTuoqorZbEa4WLD5u8Z0Ut7dRVyZEZ3HP7w31wysmCRdUVV7pJRYlsVyuWyvahcmSYLrumRZ1g4nkwlBEPA7DBlNIj6/JgyeY/p2zPA1xvRSgmDRWhPHMbZt43kejuNgaEXa1MvQJ2u15Vbx1ZPc/Rpz+9jj5qGL6Y25ddcIoc54zU/TtBXx36fo1Ebned4qlbnA9gWdUcBH84X+F5/u9wjzOUYISV0fz7yTj/8AaX4KybDeTV4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sine avg max v2 modes\"\n        title=\"sine avg max v2 modes\"\n        src=\"/static/5acb77e21c40aec4b7de52d610a27114/5a190/sine_avg_max_v2_modes.png\"\n        srcset=\"/static/5acb77e21c40aec4b7de52d610a27114/772e8/sine_avg_max_v2_modes.png 200w,\n/static/5acb77e21c40aec4b7de52d610a27114/e17e5/sine_avg_max_v2_modes.png 400w,\n/static/5acb77e21c40aec4b7de52d610a27114/5a190/sine_avg_max_v2_modes.png 800w,\n/static/5acb77e21c40aec4b7de52d610a27114/c1b63/sine_avg_max_v2_modes.png 1200w,\n/static/5acb77e21c40aec4b7de52d610a27114/21b4d/sine_avg_max_v2_modes.png 1280w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"possible-execution-model\" style=\"position:relative;\"><a href=\"#possible-execution-model\" aria-label=\"possible execution model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Possible Execution Model</h2>\n<ul>\n<li>\n<p>The initial mode will be active upon reactor startup. Others will be inactive.</p>\n</li>\n<li>\n<p>All reactions in inactive modes will not be triggered.</p>\n<ul>\n<li>Reactions will not enter reaction queue.</li>\n<li>Includes reactions in contained reactor instances.</li>\n<li><strong>Q: What about “relay reactions” for connections, should the be suppressed as well?</strong></li>\n</ul>\n</li>\n<li>\n<p>If at a logical time (t, m) <strong>(See Q1)</strong> all reactions are finished and a different mode was set, the current mode will be deactivated and the new one will be activated. No newly activated reactions will be triggered based on current inputs <strong>(See Q1)</strong>. All contained modes will be reset to their initial state <strong>(See Q2 and Q5)</strong>. All internal events/actions previously scheduled by contents of this new mode will be removed <strong>(Q: Better freeze them and introduce a mode local time line?)</strong>.</p>\n<ul>\n<li>This could also be implemented by mutations, deleting the content of the deactivated mode and adding the content of the new mode.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"questions\" style=\"position:relative;\"><a href=\"#questions\" aria-label=\"questions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Questions</h2>\n<ul>\n<li><strong>Q1:</strong> When to switch modes? 4 alternatives ordered by “immediacy”:\n<ol>\n<li><em>Immediate</em>: This will switch modes immediately such that source and target mode will be active simultaneously. This will primarily prescribe an order for the reactions in modes instead of establishing mutual exclusion.</li>\n<li><em>Micro Step</em> (current proposal): If a new mode is set at (t, m) this mode will be active at (t, m + 1).</li>\n<li><em>Logical Time</em>: Only one mode is active at all micro steps of a logical time tag t. The main question is at what time will be the next reaction, as this might depend on external inputs.</li>\n<li><em>Explicit Delay</em>: Setting a mode takes an explicit delay (like schedule) when to take the transition. Problem here is invalidating scheduled transitions by earlier ones.</li>\n</ol>\n</li>\n<li><strong>Q2:</strong> Do we want hierarchy?\n<ul>\n<li>Proposal: Yes!</li>\n</ul>\n</li>\n<li><strong>Q3:</strong> Hybrid Reactions\n<ul>\n<li>Mixing modes and reaction outside of modes in the same reactor (not done in Ptolemy/SCADE/SCCharts).</li>\n<li>Might facilitate proper startup / shutdown of a reactor.</li>\n</ul>\n</li>\n<li><strong>Q4:</strong> Preemption\n<ul>\n<li>Triggering transitions by reactions requires an active mode. This allows “weak” preemption but rules out “strong” preemption.</li>\n<li>Executing all reactions allows overruling previously set target modes. This might be unintuitive compared to transitions and priorities. An <strong>alternative</strong> might be stopping reaction execution when a mode switch was triggered.</li>\n</ul>\n</li>\n<li><strong>Q5:</strong> Do we want history transitions?\n<ul>\n<li>What about reacting to events/actions scheduled in previous activations of a mode?</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"observations\" style=\"position:relative;\"><a href=\"#observations\" aria-label=\"observations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Observations</h2>\n<ul>\n<li>\n<p>Having reactions with transition dependencies in modes allows to infer outgoing transitions of this mode.</p>\n</li>\n<li>\n<p>Using reactor instances in modes allows to model hierarchical modes.</p>\n</li>\n<li>\n<p>Having the actual triggering of an transition in reaction code only exposes which reaction triggers <em>might</em> trigger the transition.</p>\n</li>\n<li>\n<p>Marking modes as initial in LF enables proper code generation for a hierarchical reset. A more flexible <strong>alternative</strong> would be setting the initial mode in startup reactions. This would allow different initial states but would require target code parsing.</p>\n</li>\n<li>\n<p>Restricting use of modes in reactions (set_mode) may require target code parsing.</p>\n</li>\n<li>\n<p>Triggering transitions in a deadline block of a reaction corresponds to error transitions (Ptolemy).</p>\n</li>\n</ul>\n<h2 id=\"possible-extensions\" style=\"position:relative;\"><a href=\"#possible-extensions\" aria-label=\"possible extensions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Possible Extensions</h2>\n<ul>\n<li>\n<p><strong>Actions:</strong> Might be trivial as reactions to actions will be suppressed if mode is inactive. Actions scheduled in the future must be removed when entering mode.</p>\n</li>\n<li>\n<p><strong>Local State Variables</strong>: Requires initial value or a special reset reaction to properly reset the state when mode is reentered.</p>\n</li>\n<li>\n<p><strong>Timers:</strong>: Start/Restart when mode is entered. Feasibility depends on the timing of mode activation activation <strong>(See Q1)</strong>.</p>\n</li>\n<li>\n<p><strong>History Transitions:</strong></p>\n<ul>\n<li>Do not remove events/actions that were scheduled when the state was previously active.</li>\n<li>Do not reset modes in contained reactors to initial (deep history)?</li>\n<li>Omit triggering reset actions for state variables.</li>\n<li>Timers are restored, not restarted.</li>\n</ul>\n</li>\n<li>\n<p><strong>Immediate Transitions:</strong> See <strong>Q1</strong></p>\n</li>\n<li>\n<p><strong>Entry/Exit Triggers:</strong> Special trigger for reactions to pre/post-process entering/leaving of modes.</p>\n</li>\n</ul>\n<h2 id=\"optional-syntactic-sugar-for-flat-fsms\" style=\"position:relative;\"><a href=\"#optional-syntactic-sugar-for-flat-fsms\" aria-label=\"optional syntactic sugar for flat fsms permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optional Syntactic Sugar for (flat) FSMs</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">reactor TwoModes {\n  initial state One {...} //&lt;-- optional (would introduce hierarchy)\n  transition(TRIG) READ -> WRITE to Two \n    if {= GUARD =} //&lt;-- optional\n    with {= EFFECT =} //&lt;-- optional\n\n  state Two\n}</code></pre></div>\n<p>Transformed into:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">initial mode One {\n  reaction ($TRIG) $READ -> $WRITE transition Two {=\n    if ($GUARD) { //&lt;-- target language specific code generation\n      set_mode(Two)\n      $EFFECT //&lt;-- Does not work with multiple triggering transitions as all effects would be executed (not only taken transtions, see Q4)\n    }\n  =}\n}\nmode Two {\n}</code></pre></div>","headings":[{"value":"Motivation","depth":2},{"value":"Synthetic Examples","depth":3},{"value":"Design Considerations","depth":2},{"value":"Basic Syntax Proposal","depth":2},{"value":"Graphical Syntax","depth":3},{"value":"Possible Execution Model","depth":2},{"value":"Questions","depth":2},{"value":"Observations","depth":2},{"value":"Possible Extensions","depth":2},{"value":"Optional Syntactic Sugar for (flat) FSMs","depth":2}],"frontmatter":{"permalink":"/docs/handbook/rfc-modal","title":"RFC: Modal Models (Draft I)","oneline":"RFC: Modal Models (first draft)","preamble":""}},"prev":{"childMarkdownRemark":{"frontmatter":{"title":"Contributing","oneline":"Contribute to Lingua Franca.","permalink":"/docs/handbook/contributing"}}},"next":{"childMarkdownRemark":{"frontmatter":{"title":"Contributing","oneline":"Contribute to Lingua Franca.","permalink":"/docs/handbook/contributing"}}}},"pageContext":{"id":"7-rfc:-modal-models-(draft-i)","slug":"/docs/handbook/rfc-modal","repoPath":"/packages/documentation/copy/en/less-developed/RFC Modal Models (first draft).md","lang":"en","modifiedTime":"2022-04-20T15:27:18.285Z"}},
    "staticQueryHashes": []}